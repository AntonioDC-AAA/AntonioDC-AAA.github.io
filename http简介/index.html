<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="generator" content="Hugo 0.65.0-DEV" />

  <title>Http &middot; Blog</title>

  <meta name="description" content="" />

  
  <meta property="og:locale" content="en-us"/>

  
  <meta property="og:image" content="https://antoniodc-aaa.github.io/images/name.jpg">

  
  <meta property="og:type" content="blog"/>
  <meta property="og:site_name" content="Blog"/><meta property="og:title" content="Http"/>
  <meta property="og:url" content="https://antoniodc-aaa.github.io/http%E7%AE%80%E4%BB%8B/"/>
  <meta property="og:description" content="输入URL执行过程（一次完整的http请求过程） DHCP配置主机信息 假设主机最开始没有IP地址以及其他信息，需要先使用DHCP来获取
 主机生成一个DHCP请求报文，并将这个报文放具有目的端口67和68的UDP报文端中 该报文段会被放入一个具有广播IP目地址（255.255.255.255）和源地址（0.0.0.0）的IP数据报中 该数据报则被放置在MAC帧中，该帧具有目的地址FF:FF:FF:FF:FF:FF，将广播到与交换机连接的所有设备 连接在交换机的DHCP服务器收到广播帧之后，不断向上分解得到IP数据报，UDP报文端，DHCP请求报文，之后生成DHCP ACK报文，该报文包含以下信息：IP地址、DNS服务器的IP地址、默认网关路由器的IP地址和子网掩码 。该报文被放入UDP报文段中，UDP报文段有被放入IP数据报中年，最后放入MAC帧中 该帧的目的地址式请求主机的MAC地址，因为交换机具有自主学习能力，之前主机发送了广播帧之后就记录了MAC地址到转发接口的交换表项，因此现在交换机就可以直接知道应该向哪个接口发送该帧 主机收到该帧之后，不断分解得到DHCP报文。之后配置它的IP地址、子网掩码和DNS服务器的IP地址，并在其IP转发表中安装默认网关。  ARP解析MAC地址 主机通过浏览器生成一个TCP套接字，套接字向HTTP服务器发送HTTP请求，为了生成套接字，主机需要知道网站域名对应的IP地址。因为DHCP只是知道DNS服务器的IP地址，对应的需要先知道网关路由器的MAC地址。"/>

  <script type="application/ld+json">
  {
    "@context" : "http://schema.org",
    "@type" : "Blog",
    "name": "Blog",
    "url" : "https://antoniodc-aaa.github.io/",
    "image": "https://antoniodc-aaa.github.io/images/name.jpg",
    "description": "You only live once !"
  }
  </script>

  


  <link type="text/css"
        rel="stylesheet"
        href="https://antoniodc-aaa.github.io/css/print.css"
        media="print">

  <link type="text/css"
        rel="stylesheet"
        href="https://antoniodc-aaa.github.io/css/poole.css">

  <link type="text/css"
        rel="stylesheet"
        href="https://antoniodc-aaa.github.io/css/hyde.css">

  
<style type="text/css">
  .sidebar {
    background-color: #fc21803;
  }

  .read-more-link a {
    border-color: #fc21803;
  }

  footer a,
  .content a,
  .related-posts li a:hover {
    color: #fc21803;
  }
</style>



  <link type="text/css" rel="stylesheet" href="https://antoniodc-aaa.github.io/css/blog.css">

  <link rel="stylesheet"
        href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700&display=swap">

  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css"
        integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk="
        crossorigin="anonymous" />

  <link rel="apple-touch-icon-precomposed"
        sizes="144x144"
        href="/apple-touch-icon-144-precomposed.png">

  <link rel="shortcut icon" href="/favicon.png">

  
  </head>
<body>
  <aside class="sidebar">
  <div class="container">
    <div class="sidebar-about">
      
        
        <div class="author-image">
          <img src="https://antoniodc-aaa.github.io/images/name.jpg" class="img-circle img-headshot center" alt="Profile Picture">
        </div>
        
      

      <h1>Blog</h1>

      
      <p class="lead">You only live once !</p>
      
    </div>

    <nav>
      <ul class="sidebar-nav">
        <li>
          <a href="https://antoniodc-aaa.github.io/">Home</a>
        </li>
        <li>
          <a href="/post/"> Posts </a>
        </li><li>
          <a href="/tags/"> Tags </a>
        </li><li>
          <a href="/about/"> About </a>
        </li>
      </ul>
    </nav>

    <section class="social-icons">
      
      <a href="https://github.com/" rel="me" title="GitHub">
        <i class="fab fa-github" aria-hidden="true"></i>
      </a>
      
      <a href="#" rel="me" title="Twitter">
        <i class="fab fa-twitter" aria-hidden="true"></i>
      </a>
      
    </section>
  </div>
</aside>


  <main class="content container">
  <div class="post">
  <h1>Http</h1>

  

  <h1 id="输入url执行过程一次完整的http请求过程">输入URL执行过程（一次完整的http请求过程）</h1>
<h2 id="dhcp配置主机信息">DHCP配置主机信息</h2>
<p>假设主机最开始没有IP地址以及其他信息，需要先使用DHCP来获取</p>
<ul>
<li>主机生成一个DHCP请求报文，并将这个报文放具有目的端口67和68的UDP报文端中</li>
<li>该报文段会被放入一个具有广播IP目地址（255.255.255.255）和源地址（0.0.0.0）的IP数据报中</li>
<li>该数据报则被放置在MAC帧中，该帧具有目的地址FF:FF:FF:FF:FF:FF，将广播到与交换机连接的所有设备</li>
<li>连接在交换机的DHCP服务器收到广播帧之后，不断向上分解得到IP数据报，UDP报文端，DHCP请求报文，之后生成DHCP ACK报文，该报文包含以下信息：<strong>IP地址、DNS服务器的IP地址、默认网关路由器的IP地址和子网掩码</strong> 。该报文被放入UDP报文段中，UDP报文段有被放入IP数据报中年，最后放入MAC帧中</li>
<li>该帧的目的地址式请求主机的MAC地址，因为交换机具有自主学习能力，之前主机发送了广播帧之后就记录了MAC地址到转发接口的交换表项，因此现在交换机就可以直接知道应该向哪个接口发送该帧</li>
<li>主机收到该帧之后，不断分解得到DHCP报文。之后配置它的<strong>IP地址、子网掩码和DNS服务器的IP地址</strong>，并在其IP转发表中安装默认网关。</li>
</ul>
<h2 id="arp解析mac地址">ARP解析MAC地址</h2>
<p>主机通过浏览器生成一个TCP套接字，套接字向HTTP服务器发送HTTP请求，为了生成套接字，主机需要知道网站域名对应的IP地址。因为DHCP只是知道DNS服务器的IP地址，对应的需要先知道网关路由器的MAC地址。</p>
<ul>
<li>
<p>主机生成一个DNS查询报文，该报文具有53号端口，因为DNS服务器的端口是53</p>
</li>
<li>
<p>该DNS查询报文被放入目的地址为DNS服务器IP地址的IP数据报中</p>
</li>
<li>
<p>该IP数据报被放入一个以太网帧中，该帧发送到网关路由器</p>
</li>
<li>
<p>DHCP过程只知道网关路由器IP地址，为了获取网关路由器的MAC地址，需要使用ARP协议</p>
</li>
</ul>
<h2 id="dns解析域名">DNS解析域名</h2>
<p>知道了网关路由器的MAC地址后，就可以继续DNS的解析过程了。</p>
<ul>
<li>
<p>网关路由器接收到包含DNS查询报文的以太网帧后，抽取IP数据报，并根据转发表决定该IP数据报应该转发的路由器</p>
</li>
<li>
<p>因为该路由器具有内部网关协议（RIP、OSPF）和外部网关协议（BGP）这两种路由选择协议。因此路由表中已经配置了网关路由器到达DNS服务器的路由项</p>
</li>
<li>
<p>到达DNS服务器之后，DNS服务器抽取DNS查询报文，并再DNS数据库中找到待查询的域名。</p>
</li>
<li>
<p>找到DNS记录后，发送DNS回答报文，将该回答报文放入UDP报文段中，然后放入IP数据包中，通过路由器反向转发回网关路由器，并经过以太网交换机到达主机</p>
<p>域名查询的过程：</p>
<ol>
<li>
<p>浏览器搜索自己的DNS缓存（维护一张域名与IP地址对应表）</p>
</li>
<li>
<p>若没有，则搜索操作系统中DNS缓存（维护一张域名与IP地址对应表）</p>
</li>
<li>
<p>若没有，则搜索操作系统hosts文件（Windows环境中，维护一张域名与IP地址的对应表）</p>
</li>
<li>
<p>若没有，则操作系统将域名发送到<strong>本地域名服务器</strong> ，本地域名服务器查询自己的DNS缓存，查找成功则返回结果，否则</p>
<p>4.1 本地域名服务器向 根域名服务器（虽然没有每个域名的具体信息，但存储了负责每个域，如com\net\org等解析的顶级域名服务器的地址）发送请求</p>
<p>4.2  本地域名服务器向com域的顶级域名服务器发起请求，返回baidu.com权限域名服务器地址</p>
<p>4.3 本地域名服务器将得到的IP地址返回给操作系统，同时自己将IP地址缓存起来</p>
</li>
<li>
<p>本地域名服务器 将得到的IP地址返回操作系统，同时自己将IP地址缓存起来</p>
</li>
<li>
<p>至此，浏览器已经得到域名对应的IP地址</p>
</li>
</ol>
</li>
</ul>
<h2 id="tcp三次握手">TCP三次握手</h2>
<p>有了HTTP服务器的IP地址之后，主机能够生成TCP套接字，该套接字将用于向web服务器发送HTTP get报文</p>
<p>1.在生成套接字之前，必须先与HTTP服务器进行三次握手来建立连接。生成一个具有目的端口80的TCP SYN报文段，并向HTTP服务器发送该报文段</p>
<p>2.HTTP服务器收到该报文端后，生成TCP SYN ACK报文段，发送给主机。</p>
<p>3.主机 发送ACK应答给 报文段给HTTP服务器，至此，三次握手成功建立。</p>
<h2 id="http请求">HTTP请求</h2>
<p>浏览器生成HTTP GET报文，交付给HTTP服务器</p>
<p>HTTP服务器从TCP套接字中读取HTTP GET报文，生成一个HTTP响应报文，将Web页面放入到报文主体中，发送给回主机</p>
<p>浏览器收到HTTP相应报文后，抽取web页面内容，之后进行浏览器渲染，解析html源码，生成DOM树，解析css样式，js交互，客户端和服务端进行交互，ajax查询。显示web页面。</p>

</div>


  </main>

  <footer>
  <div class="copyright">
    &copy; Antonio.D.C 2020 · <a href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0</a>
  </div>
</footer>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/js/all.min.js"
          integrity="sha256-MAgcygDRahs+F/Nk5Vz387whB4kSK9NXlDN3w58LLq0="
          crossorigin="anonymous"></script>

  <script src="https://antoniodc-aaa.github.io/js/blog.js"></script>

  
</body>
</html>
